<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Data – ASME B31.3</title>

<style>
body{font-family:Arial;background:#f2f4f7}
.container{max-width:1400px;margin:20px auto;background:#fff;padding:20px;border-radius:8px}
h2{text-align:center;color:#1f4e79}
h3{color:#1f4e79;margin-top:30px}

table{
 width:100%;
 border-collapse:collapse;
 margin-top:10px
}
th,td{
 border:1px solid #ccc;
 padding:6px;
 text-align:center
}
th{background:#eef4fb}

button{
 padding:5px 12px;
 background:#c62828;
 color:#fff;
 border:none;
 cursor:pointer
}

.back{
 background:#1f4e79;
 margin-bottom:10px
}
</style>
</head>

<body>
<div class="container">

<h2>Admin Data – ASME B31.3</h2>

<button class="back" onclick="location.href='admin-entry.html'">
⬅ Back to Admin Entry
</button>

<!-- ================= MATERIAL MASTER ================= -->
<h3>Material Master</h3>
<div id="materialTable"></div>

<!-- ================= PIPE TYPE ================= -->
<h3>Pipe Type Master (E Factor)</h3>
<div id="pipeTypeTable"></div>

<!-- ================= DIMENSIONS ================= -->
<h3>Dimensions & Weights (B36.10 / B36.19)</h3>
<div id="dimTable"></div>

<!-- ================= Y FACTOR ================= -->
<h3>Y Factor – ASME B31.3</h3>
<div id="yTable"></div>

<!-- ================= W FACTOR ================= -->
<h3>W Factor – ASME B31.3</h3>
<div id="wTable"></div>

<!-- ================= STRESS ================= -->
<h3>Material Basic Allowable Stress (S)</h3>
<div id="stressTable"></div>

</div>

<script>
/* ================= LOAD DATABASE ================= */
let materialMasterDB = JSON.parse(localStorage.getItem("materialMasterDB")) || [];
let pipeTypeDB       = JSON.parse(localStorage.getItem("pipeTypeDB")) || [];
let pipeDimWeightDB  = JSON.parse(localStorage.getItem("pipeDimWeightDB")) || [];
let yDB              = JSON.parse(localStorage.getItem("yDB")) || [];
let wDB              = JSON.parse(localStorage.getItem("wDB")) || [];
let stressDB         = JSON.parse(localStorage.getItem("stressDB")) || [];

/* ================= RENDER TABLE ================= */
function renderTable(data, containerId, dbName){
 if(data.length===0){
  document.getElementById(containerId).innerHTML="<i>No data available</i>";
  return;
 }

 let html="<table><tr>";
 Object.keys(data[0]).forEach(k=>html+=`<th>${k}</th>`);
 html+="<th>Action</th></tr>";

 data.forEach((row,i)=>{
  html+="<tr>";
  Object.values(row).forEach(v=>html+=`<td>${v}</td>`);
  html+=`
   <td>
    <button onclick="deleteRow('${dbName}',${i})">Delete</button>
   </td>
  </tr>`;
 });

 html+="</table>";
 document.getElementById(containerId).innerHTML=html;
}

/* ================= DELETE ================= */
function deleteRow(dbName,index){
 if(!confirm("Are you sure you want to delete this record?")) return;

 if(dbName==="material"){
  materialMasterDB.splice(index,1);
  localStorage.setItem("materialMasterDB",JSON.stringify(materialMasterDB));
 }
 if(dbName==="pipeType"){
  pipeTypeDB.splice(index,1);
  localStorage.setItem("pipeTypeDB",JSON.stringify(pipeTypeDB));
 }
 if(dbName==="dim"){
  pipeDimWeightDB.splice(index,1);
  localStorage.setItem("pipeDimWeightDB",JSON.stringify(pipeDimWeightDB));
 }
 if(dbName==="y"){
  yDB.splice(index,1);
  localStorage.setItem("yDB",JSON.stringify(yDB));
 }
 if(dbName==="w"){
  wDB.splice(index,1);
  localStorage.setItem("wDB",JSON.stringify(wDB));
 }
 if(dbName==="stress"){
  stressDB.splice(index,1);
  localStorage.setItem("stressDB",JSON.stringify(stressDB));
 }

 loadAll();
}

/* ================= LOAD ALL ================= */
function loadAll(){
 renderTable(materialMasterDB,"materialTable","material");
 renderTable(pipeTypeDB,"pipeTypeTable","pipeType");
 renderTable(pipeDimWeightDB,"dimTable","dim");
 renderTable(yDB,"yTable","y");
 renderTable(wDB,"wTable","w");
 renderTable(stressDB,"stressTable","stress");
}

loadAll();
</script>

</body>
</html>
