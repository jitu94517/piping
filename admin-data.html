<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Data – ASME B31.3</title>

<style>
body{font-family:Arial;background:#f2f4f7}
.container{max-width:1400px;margin:20px auto;background:#fff;padding:20px;border-radius:8px}
h2{text-align:center;color:#1f4e79}
h3{color:#1f4e79;margin-top:30px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
th{background:#eef4fb}
button{padding:4px 10px;border:none;cursor:pointer}
.danger{background:#c0392b;color:#fff}
.topbar{display:flex;justify-content:space-between;align-items:center}
hr{margin:30px 0}
</style>
</head>

<body>
<div class="container">

<div class="topbar">
<h2>Admin Data – ASME B31.3</h2>
<button onclick="location.href='admin-entry.html'">⬅ Back to Admin Entry</button>
</div>

<!-- ================= MATERIAL MASTER ================= -->
<h3>Material Master</h3>
<table>
<thead>
<tr>
<th>Family</th><th>Material</th><th>Grade</th><th>Action</th>
</tr>
</thead>
<tbody id="materialTable"></tbody>
</table>

<hr>

<!-- ================= PIPE TYPE ================= -->
<h3>Pipe Type Master (E Factor)</h3>
<table>
<thead>
<tr>
<th>Pipe Type</th><th>E</th><th>Action</th>
</tr>
</thead>
<tbody id="pipeTypeTable"></tbody>
</table>

<hr>

<!-- ================= DIMENSIONS & WEIGHTS ================= -->
<h3>Dimensions and Weights of Welded and Seamless Wrought Steel Pipe</h3>
<table>
<thead>
<tr>
<th>Code</th>
<th>Material</th>
<th>NPS</th>
<th>Identification</th>
<th>Schedule</th>
<th>OD (mm)</th>
<th>Thickness (mm)</th>
<th>Weight (kg/m)</th>
<th>Action</th>
</tr>
</thead>
<tbody id="dimWeightTable"></tbody>
</table>

<hr>

<!-- ================= Y FACTOR ================= -->
<h3>Y Factor – ASME B31.3</h3>
<table>
<thead>
<tr>
<th>Material</th><th>Temperature (°C)</th><th>Y</th><th>Action</th>
</tr>
</thead>
<tbody id="yTable"></tbody>
</table>

<hr>

<!-- ================= W FACTOR ================= -->
<h3>W Factor – ASME B31.3</h3>
<table>
<thead>
<tr>
<th>Material</th><th>Temperature (°C)</th><th>W</th><th>Action</th>
</tr>
</thead>
<tbody id="wTable"></tbody>
</table>

<hr>

<!-- ================= STRESS ================= -->
<h3>Material Basic Allowable Stress (S)</h3>
<table>
<thead>
<tr>
<th>Material</th><th>Temperature (°C)</th><th>Stress (MPa)</th><th>Action</th>
</tr>
</thead>
<tbody id="stressTable"></tbody>
</table>

</div>

<script>
/* ================= LOAD DATABASES ================= */
let materialMasterDB = JSON.parse(localStorage.getItem("materialMasterDB")) || [];
let pipeTypeDB       = JSON.parse(localStorage.getItem("pipeTypeDB")) || [];
let pipeDimWeightDB  = JSON.parse(localStorage.getItem("pipeDimWeightDB")) || [];
let yDB              = JSON.parse(localStorage.getItem("yDB")) || [];
let wDB              = JSON.parse(localStorage.getItem("wDB")) || [];
let stressDB         = JSON.parse(localStorage.getItem("stressDB")) || [];

/* ================= MATERIAL MASTER ================= */
function loadMaterial(){
 materialTable.innerHTML="";
 materialMasterDB.forEach((m,i)=>{
  materialTable.innerHTML+=`
   <tr>
    <td>${m.family}</td>
    <td>${m.mat}</td>
    <td>${m.grade}</td>
    <td>
     <button class="danger" onclick="delMaterial(${i})">Del</button>
    </td>
   </tr>`;
 });
}
function delMaterial(i){
 if(confirm("Delete this material?")){
  materialMasterDB.splice(i,1);
  localStorage.setItem("materialMasterDB",JSON.stringify(materialMasterDB));
  loadMaterial();
 }
}

/* ================= PIPE TYPE ================= */
function loadPipeType(){
 pipeTypeTable.innerHTML="";
 pipeTypeDB.forEach((p,i)=>{
  pipeTypeTable.innerHTML+=`
   <tr>
    <td>${p.type}</td>
    <td>${p.E}</td>
    <td>
     <button class="danger" onclick="delPipeType(${i})">Del</button>
    </td>
   </tr>`;
 });
}
function delPipeType(i){
 if(confirm("Delete this pipe type?")){
  pipeTypeDB.splice(i,1);
  localStorage.setItem("pipeTypeDB",JSON.stringify(pipeTypeDB));
  loadPipeType();
 }
}

/* ================= DIMENSIONS & WEIGHTS ================= */
function loadDimWeight(){
 dimWeightTable.innerHTML="";
 pipeDimWeightDB.forEach((d,i)=>{
  dimWeightTable.innerHTML+=`
   <tr>
    <td>${d.code}</td>
    <td>${d.material}</td>
    <td>${d.nps}</td>
    <td>${d.identification || "-"}</td>
    <td>${d.schedule || "-"}</td>
    <td>${d.od}</td>
    <td>${d.thickness}</td>
    <td>${d.weight}</td>
    <td>
     <button class="danger" onclick="delDimWeight(${i})">Del</button>
    </td>
   </tr>`;
 });
}
function delDimWeight(i){
 if(confirm("Delete this dimension & weight entry?")){
  pipeDimWeightDB.splice(i,1);
  localStorage.setItem("pipeDimWeightDB",JSON.stringify(pipeDimWeightDB));
  loadDimWeight();
 }
}

/* ================= Y FACTOR ================= */
function loadY(){
 yTable.innerHTML="";
 yDB.forEach((y,i)=>{
  yTable.innerHTML+=`
   <tr>
    <td>${y.mat}</td>
    <td>${y.temp}</td>
    <td>${y.Y}</td>
    <td>
     <button class="danger" onclick="delY(${i})">Del</button>
    </td>
   </tr>`;
 });
}
function delY(i){
 if(confirm("Delete Y factor entry?")){
  yDB.splice(i,1);
  localStorage.setItem("yDB",JSON.stringify(yDB));
  loadY();
 }
}

/* ================= W FACTOR ================= */
function loadW(){
 wTable.innerHTML="";
 wDB.forEach((w,i)=>{
  wTable.innerHTML+=`
   <tr>
    <td>${w.mat}</td>
    <td>${w.temp}</td>
    <td>${w.W}</td>
    <td>
     <button class="danger" onclick="delW(${i})">Del</button>
    </td>
   </tr>`;
 });
}
function delW(i){
 if(confirm("Delete W factor entry?")){
  wDB.splice(i,1);
  localStorage.setItem("wDB",JSON.stringify(wDB));
  loadW();
 }
}

/* ================= STRESS ================= */
function loadStress(){
 stressTable.innerHTML="";
 stressDB.forEach((s,i)=>{
  stressTable.innerHTML+=`
   <tr>
    <td>${s.mat}</td>
    <td>${s.temp}</td>
    <td>${s.stress}</td>
    <td>
     <button class="danger" onclick="delStress(${i})">Del</button>
    </td>
   </tr>`;
 });
}
function delStress(i){
 if(confirm("Delete stress entry?")){
  stressDB.splice(i,1);
  localStorage.setItem("stressDB",JSON.stringify(stressDB));
  loadStress();
 }
}

/* ================= INIT ================= */
loadMaterial();
loadPipeType();
loadDimWeight();
loadY();
loadW();
loadStress();
</script>

</body>
</html>
